<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cƒê ITC-Tr√≤ Ch∆°i Ch√©m Hoa Qu·∫£</title>
    <!-- SEO Meta Tags -->
    <meta name="description"
        content="Tham gia tr√≤ ch∆°i ch√©m hoa qu·∫£ vui nh·ªôn t·∫°i Cƒê ITC! N√¢ng cao ƒëi·ªÉm s·ªë v√† th√°ch th·ª©c b·∫£n th√¢n trong 60 gi√¢y!">
    <meta name="keywords" content="tr√≤ ch∆°i, ch√©m hoa qu·∫£, Cƒê ITC, game, vui nh·ªôn, gi·∫£i tr√≠">
    <meta name="author" content="T√™n c·ªßa b·∫°n ho·∫∑c T·ªï ch·ª©c">

    <link rel="icon" href="URL ƒë·∫øn favicon" type="image/png">

    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #f0f8ff;
            font-family: Arial, sans-serif;
        }

        canvas {
            display: block;
            margin: auto;
            background-color: #fff;
            border: none;
        }

        #score {
            position: absolute;
            top: 10px;
            left: 10px;
            font-size: 24px;
            text-decoration: none;
            background: linear-gradient(250deg, #ec1d25, #0d296b);
            color: transparent;
            background-clip: text;
        }

        #timer {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 24px;
            text-decoration: none;
            background: linear-gradient(250deg, #ec1d25, #0d296b);
            color: transparent;
            background-clip: text;
        }

        #dateTime {
            position: absolute;
            top: 50px;
            left: 10px;
            font-size: 18px;
            text-decoration: none;
            background: linear-gradient(250deg, #ec1d25, #0d296b);
            color: transparent;
            background-clip: text;
        }

        #gameOver {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 20px;
            text-decoration: none;
            background: linear-gradient(250deg, #ec1d25, #0d296b);
            color: transparent;
            background-clip: text;
        }

        .slice {
            position: absolute;
            width: 50px;
            height: 50px;
            background-image: url('./image/hinhchem.png');
            /* Thay b·∫±ng URL c·ªßa h√¨nh ·∫£nh */
            background-size: cover;
            pointer-events: none;
            animation: sliceEffect 0.5s forwards;
        }

        @keyframes sliceEffect {
            0% {
                transform: scale(1);
                opacity: 1;
            }

            50% {
                transform: scale(1.5);
                opacity: 0.7;
            }

            100% {
                transform: scale(0);
                opacity: 0;
            }
        }

        .slash {
            position: absolute;
            pointer-events: none;
            transition: opacity 0.3s ease;
            opacity: 1;
        }
    </style>
</head>

<body>
    <div><a href="../page/doidiem.html"
            style="text-decoration: none; position: absolute; top: 11%; left: 1%; color: #7a3e10; border: #7a3e10 solid 1px;">ƒê·ªïi
            ƒëi·ªÉm</a></div>
    <div id="score">ƒêi·ªÉm: 0</div>
    <div id="timer">Th·ªùi gian: 60</div>
    <div id="dateTime">Ng√†y: <span id="date"></span> | Th·ªùi gian: <span id="time"></span></div>
    <div id="gameOver">Tr√≤ Ch∆°i K·∫øt Th√∫c! ƒêi·ªÉm: <span id="finalScore"></span></div>
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        let score = 0;
        let fruits = [];
        const fruitImages = ['üçé', 'üçå', 'üçâ', 'üçá', 'üçç', 'üçì', 'üçè', 'ü•ù', 'ü••', 'üéÉ', 'üåæ', 'üçã'];
        let timer = 60;
        let gameInterval;
        let isSlashing = false;
        let points = []; // M·∫£ng l∆∞u tr·ªØ c√°c ƒëi·ªÉm ch√©m

        function Fruit() {
            this.x = Math.random() * canvas.width;
            this.y = canvas.height;
            this.size = 50;
            this.image = fruitImages[Math.floor(Math.random() * fruitImages.length)];
            this.speed = 2 + Math.random() * 3;

            this.update = function () {
                this.y -= this.speed;
                if (this.y < -this.size) {
                    this.reset();
                }
            };

            this.reset = function () {
                this.y = canvas.height;
                this.x = Math.random() * canvas.width;
            };

            this.draw = function () {
                ctx.font = '40px Arial';
                ctx.fillText(this.image, this.x, this.y);
            };
        }

        function spawnFruit() {
            fruits.push(new Fruit());
        }

        function update() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            fruits.forEach((fruit, index) => {
                fruit.update();
                fruit.draw();
                if (fruit.y < 0) {
                    fruits.splice(index, 1);
                }
            });
            drawSlash(); // V·∫Ω ƒë∆∞·ªùng ch√©m
            requestAnimationFrame(update);
        }

        function handleTouchStart(event) {
            const touchX = event.touches[0].clientX;
            const touchY = event.touches[0].clientY;
            checkFruitCollision(touchX, touchY);
            isSlashing = true;
            points = [{ x: touchX, y: touchY }]; // B·∫Øt ƒë·∫ßu m·∫£ng v·ªõi ƒëi·ªÉm ƒë·∫ßu ti√™n
        }

        function handleTouchMove(event) {
            if (!isSlashing) return;
            const touchX = event.touches[0].clientX;
            const touchY = event.touches[0].clientY;
            checkFruitCollision(touchX, touchY);
            points.push({ x: touchX, y: touchY }); // Th√™m ƒëi·ªÉm m·ªõi v√†o m·∫£ng
        }

        function handleTouchEnd() {
            isSlashing = false;
            points = []; // X√≥a ƒëi·ªÉm khi k·∫øt th√∫c ch√©m
        }

        function checkFruitCollision(touchX, touchY) {
            fruits.forEach((fruit, index) => {
                if (touchX >= fruit.x && touchX <= fruit.x + fruit.size &&
                    touchY >= fruit.y - fruit.size && touchY <= fruit.y) {
                    score++;
                    document.getElementById('score').innerText = 'ƒêi·ªÉm: ' + score;
                    createSliceEffect(fruit.x, fruit.y);
                    fruits.splice(index, 1);
                }
            });
        }

        function createSliceEffect(x, y) {
            const slice = document.createElement('div');
            slice.className = 'slice';
            slice.style.left = `${x}px`;
            slice.style.top = `${y - 50}px`; // ƒê·∫©y l√™n m·ªôt ch√∫t ƒë·ªÉ hi·ªÉn th·ªã t·ªët h∆°n
            document.body.appendChild(slice);
            setTimeout(() => {
                slice.remove();
            }, 500);
        }

        function drawSlash() {
            if (points.length < 2) return; // Kh√¥ng ƒë·ªß ƒëi·ªÉm ƒë·ªÉ v·∫Ω

            ctx.strokeStyle = '#F0FFFF';
            ctx.lineWidth = 5;
            ctx.lineCap = 'round';
            ctx.beginPath();
            ctx.moveTo(points[0].x, points[0].y);

            for (let i = 1; i < points.length; i++) {
                ctx.lineTo(points[i].x, points[i].y);
            }

            ctx.stroke();
        }

        function updateTimer() {
            timer--;
            document.getElementById('timer').innerText = 'Th·ªùi gian: ' + timer;

            if (timer <= 0) {
                clearInterval(gameInterval);
                endGame();
            }
        }

        function endGame() {
            document.getElementById('gameOver').style.display = 'block';
            document.getElementById('finalScore').innerText = score;
            canvas.style.display = 'none';
        }

        function updateDateTime() {
            const now = new Date();
            const dateString = now.toLocaleDateString('vi-VN');
            const timeString = now.toLocaleTimeString('vi-VN');
            document.getElementById('date').innerText = dateString;
            document.getElementById('time').innerText = timeString;
        }

        canvas.addEventListener('touchstart', handleTouchStart);
        canvas.addEventListener('touchmove', handleTouchMove);
        canvas.addEventListener('touchend', handleTouchEnd);
        setInterval(spawnFruit, 1000);
        gameInterval = setInterval(updateTimer, 1000);
        update();
        setInterval(updateDateTime, 1000); // C·∫≠p nh·∫≠t th·ªùi gian m·ªói gi√¢y

        window.onload = function () {
            alert("Ch√†o m·ª´ng b·∫°n ƒë·∫øn v·ªõi tr√≤ ch∆°i Ch√©m Hoa Qu·∫£ t·∫°i | TR∆Ø·ªúNG Cƒê C√îNG NGH·ªÜ TH√îNG TIN TP. HCM b·∫Øt ƒë·∫ßu ch∆°i n√†o!");
            updateDateTime(); // C·∫≠p nh·∫≠t ngay khi t·∫£i trang
        };
    </script>
</body>

</html>